/*!
* jQuery Custom Select Manager function
* Copyright 2011, Ray Brooks
* Requires jQuery Core 1.4+ - http://www.jquery.com/
* Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(a){a.fn.flyweightCustomSelect=function(b){var d=a.extend({},a.fn.flyweightCustomSelect.settings,b),f=a.fn.flyweightCustomSelect.menu||null;var c=function(i,h){return((h%i)+i)%i};var e=function(){var y=null,s=null,t=false,B=null,h=-1,n="",o=[],p=null;var r=function(){o=a.map(a(d.optionfilter,s),function(E,C){var D=a(E);return{type:E.nodeName,index:D.attr("index"),text:D.attr("text"),value:D.attr("value"),group:D.attr("label")}})};var m=function(C,D){return'<li><a  class="'+d.classes.menu.listitem.base+'"data-value="'+C+'" href="#">'+D+"</a></li>"};var z=function(){var D=0,C='<ul class="'+d.classes.menu.list.base+'">';while(D<o.length){if(o[D].type==="OPTGROUP"){C+='<li class="'+d.classes.menu.group.base+'"><span>'+o[D].group+"</span><ul>";D+=1;while(D<o.length&&o[D].type!=="OPTGROUP"){C+=m(o[D].value,o[D].text);D+=1}C+="</ul></li>"}else{C+=m(o[D].value,o[D].text);D+=1}}a(B).html(C+"</ul>")};var k=function(){var C=a(y).offset();C.top+=a(y).height();B.style.left=C.left+"px";B.style.top=C.top+"px"};var i=function(){var D=a(B),C=a(s).width();if(C>D.width()){D.find("ul").width(C);if(D.find("ul").flyweightCustomSelect.hasScrollBar()){D.find("li").width(C-17)}else{D.find("li").width(C)}}};var v=function(){var C=a(B);if(C.offset().top+C.height()>a(window).height()){var D=a.browser.webkit?window.document.body:"html";a(D).animate({scrollTop:parseInt(B.style.top,10)-100},1000)}};var l=function(C){s.value=o[C].value;s.selectedIndex=o[C].index;a(s).trigger("change")};var q=function(C){var D=a(B),E;l(C);E=D.find('a[data-value="'+o[C].value+'"]');D.find("ul").scrollTop(0);D.find("a").removeClass(d.classes.menu.listitem.focus);if(E.length>0){E.addClass(d.classes.menu.listitem.focus);D.find("ul").scrollTop(E.position().top)}a(y).find("span."+d.classes.placeholder.text.base).text(E.text())};var A=function(C,E){var D=o.length-1;while(D>0&&o[D][C]!==E){D-=1}q(D)};var u=function(){var E=n.replace(/[\W]/ig,"").toUpperCase(),D=false,C=0;for(C=0;C<o.length;C+=1){if(o[C].text){if(o[C].text.replace(/[\W]/ig,"").substring(0,E.length).toString().toUpperCase()===E){A("value",o[C].value);C=o.length;D=true}}}window.clearTimeout(p);p=window.setTimeout(function(){n=""},1000)};var j=function(F){var D=F.target,E,C;F.preventDefault();F.stopPropagation();if(D.nodeName.toLowerCase()!=="a"){return false}A("value",a(D).attr("data-value"));f.close()};var x=function(D){var C=o.length;while(C--){if(o[C].index===s.selectedIndex+D){q(C);C=0}}};var w=function(){var C;B=window.document.createElement("div");B.className=d.classes.menu.container.base;a("body").append(B);C=a(B);C.bind("click",j)};w();return{open:function(E,C){var D;y=E;s=C;h=s.selectedIndex;r();z();k();i();v();A("index",h);a(B).addClass(d.classes.menu.container.open);a(y).addClass(d.classes.placeholder.container.open);t=true;n="";window.clearTimeout(p)},close:function(){a(B).removeClass(d.classes.menu.container.open);a(y).removeClass(d.classes.placeholder.container.open);t=false},reset:function(){A("index",h);this.close()},visible:function(){return t},enabled:function(){return true},scrollDown:function(){x(1)},scrollUp:function(){x(-1)},search:function(C){n+=C;u()},getSelect:function(){return s}}};var g=function(i){var r="";var s;var q=true;var o=function(u){u.stopPropagation();u.preventDefault();if(q){if(!f.visible()){f.open(this,i)}else{f.close();if(f.getSelect()!==i){f.open(this,i)}}}};var j=function(u){if(u.which===d.keymap.left||u.keyCode===d.keymap.right||u.keyCode===d.keymap.up||u.keyCode===d.keymap.down||u.keyCode===d.keymap.enter){u.stopPropagation();u.preventDefault()}switch(true){case (u.which===d.keymap.left):case (u.which===d.keymap.up):if(f.visible()){f.scrollUp()}else{a(this).trigger("click")}return false;case (u.which===d.keymap.right):case (u.which===d.keymap.down):if(f.visible()){f.scrollDown()}else{a(this).trigger("click")}return false;case (u.which===d.keymap.enter):case (u.which===d.keymap.tab):case (u.which===d.keymap.space):if(f.visible()){f.close()}else{if(u.which===d.keymap.enter||u.which===d.keymap.space){a(this).trigger("click");return false}else{f.close()}}break;case (u.which===d.keymap.escape):f.reset();return false;case (u.which>=48&&u.which<=59):case (u.which>=65&&u.which<=90):case (u.which>=97&&u.which<=122):if(!f.visible()){a(this).trigger("click")}f.search(String.fromCharCode(u.which));break}};var p=function(u){a(this).addClass(d.classes.placeholder.container.focus)};var h=function(u){a(this).removeClass(d.classes.placeholder.container.focus)};var m=function(u){a(this).addClass(d.classes.placeholder.container.hover)};var n=function(u){a(this).removeClass(d.classes.placeholder.container.hover)};var l=function(){s.click(o);s.keydown(j);s.focus(p);s.blur(h);s.hover(m,n)};var k=function(){s.unbind("click");s.unbind("keydown");s.unbind("focus");s.unbind("blur");s.unbind("mouseover");s.unbind("mouseout")};var t=function(){if(i.selectedIndex>=0){r=i.options[i.selectedIndex].text}else{r=i.options[0].text}s=a('<a href="#" aria-owns="'+i.id+'" class="'+d.classes.placeholder.container.base+'" role="button" href="#" tabindex="0" aria-haspopup="true" id="'+i.id+'-button"><span class="'+d.classes.placeholder.text.base+'">'+r+'</span><span class="'+d.classes.placeholder.arrow.base+'"></span></a>');l();a(i).after(s);a(i).hide()};t();return s[0]};if(f===null){a.fn.flyweightCustomSelect.menu=new e();f=a.fn.flyweightCustomSelect.menu;f.close()}return this.each(function(){return new g(this)})};
/*!
	 * hasScrollBar function
	 * Adapted from code
	 * Copyright 2011, Pravee Prasad
	 * See http://stackoverflow.com/users/183200/praveen-prasad http://stackoverflow.com/questions/2059743/detect-elements-overflow-using-jquery/2060003#2060003
	 */
a.fn.flyweightCustomSelect.hasScrollBar=function(){var c=this;var b=false;if((c.clientHeight<c.scrollHeight)||(c.clientWidth<c.scrollWidth)){b=true}return b};a.fn.flyweightCustomSelect.settings={classes:{placeholder:{container:{base:"jquery-flyweight-select",open:"jquery-flyweight-select-open",hover:"jquery-flyweight-select-hover",focus:"jquery-flyweight-select-focus",disabled:"jquery-flyweight-select-disabled"},text:{base:"jquery-flyweight-select-text"},arrow:{base:"jquery-flyweight-select-arrow"}},menu:{container:{base:"jquery-flyweight-selectmenu",open:"jquery-flyweight-selectmenu-open"},list:{base:"jquery-flyweight-selectmenu-list"},listitem:{base:"jquery-flyweight-selectmenu-listitem",focus:"jquery-flyweight-selectmenu-listitem-focus",hover:"jquery-flyweight-selectmenu-listitem-hover"},group:{base:"jquery-flyweight-selectmenu-group"}}},optionfilter:'option[value!=""],optgroup',keymap:{left:a.ui.keyCode.LEFT,right:a.ui.keyCode.RIGHT,up:a.ui.keyCode.UP,down:a.ui.keyCode.DOWN,enter:a.ui.keyCode.ENTER,space:a.ui.keyCode.SPACE,tab:a.ui.keyCode.TAB,escape:a.ui.keyCode.ESCAPE}}}(jQuery));