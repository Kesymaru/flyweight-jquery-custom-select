/*!
* jQuery Custom Select Manager function
* Copyright 2011, Ray Brooks
* Requires jQuery Core 1.4+ - http://www.jquery.com/
* Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(a){a.fn.flyweightCustomSelect=function(h){var d={},f=a.fn.flyweightCustomSelect.menu||null;var c=function(j,i){return((i%j)+j)%j};var e=function(){var z=null,t=null,u=false,B=null,i=0,n="",o=[],p=null;var s=function(){o=a.map(a(d.optionfilter,t),function(H,F){var G=a(H),E=G.attr("index");if(a.browser.msie&&H.nodeName.toUpperCase()==="OPTGROUP"){E=null}return{type:H.nodeName.toUpperCase(),selectIndex:E,text:G.attr("text"),value:G.attr("value"),group:G.attr("label"),hidden:false}});if(o[0].type==="OPTION"&&d.pleaseselect){o[0].hidden=true}};var m=function(E,F){return'<li><a  class="'+d.classes.menu.listitem.base+'"data-index="'+E+'" href="#">'+F+"</a></li>"};var r=function(){var F=0,E='<ul class="'+d.classes.menu.list.base+'">';while(F<o.length){if(o[F].type==="OPTGROUP"){E+='<li class="'+d.classes.menu.group.base+'"><span>'+o[F].group+"</span><ul>";F+=1;while(F<o.length&&o[F].type!=="OPTGROUP"){E+=m(o[F].selectIndex,o[F].text);F+=1}E+="</ul></li>"}else{if(!o[F].hidden){E+=m(o[F].selectIndex,o[F].text)}F+=1}}a(B).html(E+"</ul>")};var C=function(){var E=a(z).offset();E.top+=a(z).height();B.style.left=E.left+"px";B.style.top=E.top+"px"};var j=function(){var F=a(B),E=a(t).width();if(E>F.width()){F.find("ul").width(E);if(F.find("ul").flyweightCustomSelect.hasScrollBar()){F.find("li").width(E-17)}else{F.find("li").width(E)}}};var w=function(){var E=a(B);if(E.offset().top+E.height()>a(window).height()){var F=a.browser.webkit?window.document.body:"html";a(F).animate({scrollTop:parseInt(B.style.top,10)-100},1000)}};var l=function(E){t.value=o[E].value;t.selectedIndex=o[E].selectIndex;a(z).find("span."+d.classes.placeholder.text.base).text(o[E].text);a(t).trigger("change")};var q=function(E){var F=a(B),G;l(E);G=F.find('a[data-index="'+o[E].selectIndex+'"]');F.find("ul").scrollTop(0);F.find("a").removeClass(d.classes.menu.listitem.focus);if(G.length>0){G.addClass(d.classes.menu.listitem.focus);F.find("ul").scrollTop(G.position().top)}};var D=function(E,G){var F=o.length-1;while(F>0&&o[F][E]!==G){F-=1}return F};var A=function(E,F){q(D(E,F))};var v=function(){var G=n.replace(/[\W]/ig,"").toUpperCase(),F=false,E=0;for(E=0;E<o.length;E+=1){if(o[E].text){if(o[E].text.replace(/[\W]/ig,"").substring(0,G.length).toString().toUpperCase()===G){A("text",o[E].text);E=o.length;F=true}}}window.clearTimeout(p);p=window.setTimeout(function(){n=""},1000)};var k=function(H){var F=H.target,G,E;H.preventDefault();H.stopPropagation();if(F.nodeName.toUpperCase()!=="A"){return false}l(D("selectIndex",parseInt(F.getAttribute("data-index"),10)));f.close()};var y=function(F){var E=o.length;while(E){E-=1;if(o[E].selectIndex===t.selectedIndex+F){if(!o[E].hidden){q(E)}E=0}}};var x=function(){B=window.document.createElement("div");B.className=d.classes.menu.container.base;a("body").append(B);a(B).bind("click",k)};x();return{open:function(F,E){z=F;t=E;s();r();C();j();w();i=D("selectIndex",t.selectedIndex);q(i);a(B).addClass(d.classes.menu.container.open);a(z).addClass(d.classes.placeholder.container.open);u=true;n="";window.clearTimeout(p)},close:function(){a(B).removeClass(d.classes.menu.container.open);a(z).removeClass(d.classes.placeholder.container.open);u=false},destroy:function(){a(B).unbind();a(B).remove()},reset:function(){q(i);this.close()},visible:function(){return u},enabled:function(){return true},scrollDown:function(){y(1)},scrollUp:function(){y(-1)},search:function(E){n+=E;v()},getSelect:function(){return t}}};var g=function(j){var s="",t,r=true;var p=function(v){v.stopPropagation();v.preventDefault();if(r){if(!f.visible()){f.open(this,j)}else{f.close();if(f.getSelect()!==j){f.open(this,j)}}}};var k=function(v){if(v.which===d.keymap.left||v.keyCode===d.keymap.right||v.keyCode===d.keymap.up||v.keyCode===d.keymap.down||v.keyCode===d.keymap.enter||v.keyCode===d.keymap.space){v.stopPropagation();v.preventDefault()}switch(true){case (v.which===d.keymap.left):case (v.which===d.keymap.up):if(!f.visible()){a(this).trigger("click")}f.scrollUp();break;case (v.which===d.keymap.right):case (v.which===d.keymap.down):if(!f.visible()){a(this).trigger("click")}f.scrollDown();break;case (v.which===d.keymap.enter):case (v.which===d.keymap.tab):case (v.which===d.keymap.space):if(v.which===d.keymap.enter||v.which===d.keymap.space){a(this).trigger("click")}else{f.close()}break;case (v.which===d.keymap.escape):f.reset();break;case (v.which>=48&&v.which<=59):case (v.which>=65&&v.which<=90):case (v.which>=97&&v.which<=122):if(!f.visible()){a(this).trigger("click")}f.search(String.fromCharCode(v.which));break}};var q=function(v){a(this).addClass(d.classes.placeholder.container.focus)};var i=function(v){a(this).removeClass(d.classes.placeholder.container.focus)};var n=function(v){a(this).addClass(d.classes.placeholder.container.hover)};var o=function(v){a(this).removeClass(d.classes.placeholder.container.hover)};var m=function(){a(j).removeAttr("disabled");t.removeClass(d.classes.placeholder.container.disabled);t.click(p);t.keydown(k);t.focus(q);t.blur(i);t.hover(n,o)};var l=function(){a(j).attr("disabled","disabled");t.addClass(d.classes.placeholder.container.disabled);t.unbind("click");t.unbind("keydown");t.unbind("focus");t.unbind("blur");t.unbind("mouseover");t.unbind("mouseout")};var u=function(){var v=j.options[j.selectedIndex].text;t=a('<a href="#" aria-owns="'+j.id+'" class="'+d.classes.placeholder.container.base+'" role="button" href="#" tabindex="0" aria-haspopup="true" id="'+j.id+'-button"><span class="'+d.classes.placeholder.text.base+'">'+v+'</span><span class="'+d.classes.placeholder.arrow.base+'"></span></a>');m();a(j).after(t);a(j).hide();return t[0]};u();return{enable:function(){m()},disable:function(){l()},destroy:function(){t.unbind();t.remove();a(j).removeAttr("disabled").show()}}};var b={init:function(i){d=a.extend({},a.fn.flyweightCustomSelect.settings,i);if(f===null){f=a.fn.flyweightCustomSelect.menu=new e()}f.close();return this.each(function(){if(!a(this).data("placeHolder")){a(this).data("placeHolder",new g(this))}})},destroy:function(){f.destroy();f=a.fn.flyweightCustomSelect.menu=null;return this.each(function(){a(this).data("placeHolder").destroy();a(this).data("placeHolder",null)})},enable:function(){return this.each(function(){a(this).data("placeHolder").enable()})},disable:function(){return this.each(function(){a(this).data("placeHolder").disable()})}};if(b[h]){return b[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof h==="object"||!h){return b.init.apply(this,arguments)}else{a.error("Method "+h+" does not exist on jQuery.flyweightCustomSelect")}}};
/*!
	 * hasScrollBar function
	 * Adapted from code
	 * Copyright 2011, Pravee Prasad
	 * See http://stackoverflow.com/users/183200/praveen-prasad http://stackoverflow.com/questions/2059743/detect-elements-overflow-using-jquery/2060003#2060003
	 */
a.fn.flyweightCustomSelect.hasScrollBar=function(){var c=this;var b=false;if((c.clientHeight<c.scrollHeight)||(c.clientWidth<c.scrollWidth)){b=true}return b};a.fn.flyweightCustomSelect.settings={classes:{placeholder:{container:{base:"jquery-flyweight-select",open:"jquery-flyweight-select-open",hover:"jquery-flyweight-select-hover",focus:"jquery-flyweight-select-focus",disabled:"jquery-flyweight-select-disabled"},text:{base:"jquery-flyweight-select-text"},arrow:{base:"jquery-flyweight-select-arrow"}},menu:{container:{base:"jquery-flyweight-selectmenu",open:"jquery-flyweight-selectmenu-open"},list:{base:"jquery-flyweight-selectmenu-list"},listitem:{base:"jquery-flyweight-selectmenu-listitem",focus:"jquery-flyweight-selectmenu-listitem-focus",hover:"jquery-flyweight-selectmenu-listitem-hover"},group:{base:"jquery-flyweight-selectmenu-group"}}},optionfilter:"option,optgroup",pleaseselect:true,keymap:{left:a.ui.keyCode.LEFT,right:a.ui.keyCode.RIGHT,up:a.ui.keyCode.UP,down:a.ui.keyCode.DOWN,enter:a.ui.keyCode.ENTER,space:a.ui.keyCode.SPACE,tab:a.ui.keyCode.TAB,escape:a.ui.keyCode.ESCAPE}}}(jQuery));